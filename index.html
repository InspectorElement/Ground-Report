  <!DOCTYPE html>
  <html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width">
    <title>Ground Report</title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.0/jquery.min.js"></script>
    <script src="https://cloudboost.io/js-sdk/cloudboost.js"></script>
    <link href="https://fonts.googleapis.com/css?family=Nunito" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Nunito:extra-bold" rel="stylesheet">
    <script src="https://developers.google.com/maps/documentation/javascript/examples/markerclusterer/markerclusterer.js"></script>
    <style>
      .section input[type="radio"] {
        display: none;
      }
      .container {
        margin-bottom: 10px;
      }
      body {
        background-color: #FEFEFA;
        color: #383838;
        margin: 5px;
        font-family: 'Nunito', sans-serif;
      }
      h1 {
        color: #ee4b28;
      }
      button {
        background-color: #ee4b28;
        border: 1px solid #ee4b28;
        color: #f2f2f2;
        height: 30px;
        border-radius: 5px;
        margin: 5px;
        font-size: 15px;
        font-family: 'Nunito', sans-serif;
      }
      #map {
        height: 400px;
        width: 75%;
      }
      button:active {
        background-color: #bd2f0f;
        border: 1px solid #bd2f0f;
        color: #f2f2f2;
        height: 30px;
        border-radius: 5px;
        margin: 5px;
      }
      input {
        background-color: #f2f2f2;
        border: 1px solid #ee4b28;
        color: #383838;
        height: 30px;
        margin: 5px;
      }
      ::-webkit-input-placeholder {
        color: #383838;
      }
      ::-moz-placeholder {
        color: #383838;
      }
      :-ms-input-placeholder {
        color: #383838;
      }
      :-moz-placeholder {
        color: #383838;
      }
      .container label {
        position: relative;
      }
      .container span::before,
      .container span::after {
        content: '';
        position: absolute;
        top: 0;
        bottom: 0;
        margin: auto;
        font-family: 'Nunito', sans-serif;
      }
      .container span.radio:hover {
        cursor: pointer;
        font-family: 'Nunito', sans-serif;
      }
      .container span.radio::before {
        left: -52px;
        width: 45px;
        height: 25px;
        background-color:  #b3b3b3;
        border-radius: 50px;
        font-family: 'Nunito', sans-serif;
        text-align: left;
      }
      .container span.radio::after {
        left: -49px;
        width: 17px;
        height: 17px;
        border-radius: 10px;
        background-color:  #737373;
        transition: left .25s, background-color .25s;
        font-family: 'Nunito', sans-serif;
      }
      input[type="radio"]:checked + label span.radio::after {
        left: -27px;
        background-color: #ee4b28;
        font-family: 'Nunito', sans-serif;
      }
      p {
        margin-left: 25%;
        margin-right: 25%;
        font-family: 'Nunito', sans-serif;
      }
      strong {
        font-family: 'Nunito', sans-serif;
        font-weight: extra-bold;
      }
      #first {
        margin-left: 48%;
        margin-top: 20px;
        text-align: left;
      }
    </style>
  </head>
  <body>
  <center>
  <p><strong><strong>Anonymously report violence at protests.</strong></strong></p>
  <form id="select">
    <section id="first" class="section">
      <div class="container">
      <input type="radio" name="type" value="Mace" id="mace"><label for="mace"><span class="radio">Mace</span></label><br>
      </div>
      <div class="container">
      <input type="radio" name="type" value="Tear Gas" id="tear"><label for="tear"><span class="radio">Tear Gas</span></label><br>
      </div>
      <div class="container">
      <input type="radio" name="type" value="Rubber Bullets" id="rubber"><label for="rubber"><span class="radio">Rubber Bullets</span></label><br>
      </div>
      <div class="container">
      <input type="radio" name="type" value="Water Cannons" id="water"><label for="water"><span class="radio">Water Cannons</span></label><br>
      </div>
      <div class="container">
      <input type="radio" name="type" value="Flares" id="flares"><label for="flares"><span class="radio">Flares</span></label><br>
      </div>
      <div class="container">
      <input type="radio" name="type" value="Flash Grenades" id="flash"><label for="flash"><span class="radio">Flash Grenades</span></label><br>
      </div>
      <div class="container">
      <input type="radio" name="type" value="Medic Needed" id="medic"><label for="medic"><span class="radio">Medic Needed</span></label><br>
      </div>
    </section>
  </form><br>
   <button id="submit" onclick="geoFindMe()">Submit</button><br><br>
  <div id="message"></div><br>
  <div id="map"></div><br><br>
  </body>
  <script>
  var latitude;
  var longitude;
  var incidents = [];
  CB.CloudApp.init('piawrqmdcydf', '1cc906b3-85c5-423f-9aca-2aec7c9539b0');
  function initMap() {
    var query = new CB.CloudQuery("report");
    query.exists('type');
    query.find({
      success: function(list) {
        console.log(list);
        for (var i = 0; i < list.length; i++) {
          var lat = list[i].document.latitude;
          var lon = list[i].document.longitude;
          var latlong = { "lat": lat, "lng": lon };
          incidents.push(latlong);
          console.log(incidents);
          var mapPlace = document.getElementById("map");
          var map = new google.maps.Map(mapPlace, {
            zoom: 4,
            center: {lat: 40.7128, lng: -74.0059},
            gestureHandling: 'auto'
          });
          var markers = incidents.map(function(location, i) {
            var type = list[i].document.type;
            return new google.maps.Marker({
              position: location,
              label: type,
              primaryColor: "#ee4b28"
            });
          });
          var markerCluster = new MarkerClusterer(map, markers, {
            imagePath: 'https://developers.google.com/maps/documentation/javascript/examples/markerclusterer/m'
            });
        }
      },
      error: function(err) {
        var message = "It seems that you are not connected to the internet. Please try again.";
        $("#message").html(message);
      }
    })
  }
  function geoFindMe() {
    var output = document.getElementById("out");
    if (!navigator.geolocation){
      console.log("Geolocation is not supported by your browser.</p>");
      return;
    }
    function success(position) {
      latitude  = position.coords.latitude;
      longitude = position.coords.longitude;
        if ($("#select").val() == "null") {
          var message = "Please select a valid option.";
          $("#message").html(message);
        }
        else {
          var message = "Your report has been received.";
          $("#message").html(message);
          var obj = new CB.CloudObject("report");
          obj.set("type", document.querySelector('[name="type"]:checked').value);
          obj.set("latitude", latitude);
          obj.set("longitude", longitude);
          obj.save({
            success: function(obj) {
              console.log("Save function successful.");
              $("#find").show();
            },
            error: function(err) {
              var message = "It seems that you are not connected to the internet. Please try again.";
              $("#message").html(message);
            }
          });
        }
      }
      function error() {
        console.log("Unable to retrieve your location");
      }
      navigator.geolocation.getCurrentPosition(success, error);
    };
  </script>
  <script async defer src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCBfZmoz6oPPvfNswTnm9z2mtNsmjCM9Yo&callback=initMap"></script>
  </html>
